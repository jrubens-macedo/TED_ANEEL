import pandas as pd

# Lista de valores para manter na primeira coluna
valores_permitidos = [
    3012034985, 3013501533, 3013508482, 3013508513, 3013510908, 3013511465, 3013528208,
    3013533226, 3013536708, 3013545314, 3013545326, 3013545376, 3013545380, 3013549485,
    3013549488, 3013549490, 3013554201, 3013564293, 3013564396, 3013567594, 3013567635,
    3013567733, 3013568024, 3013568035, 3013586185, 3013586192, 3013614208, 3013614213,
    3013614221, 3013645021, 3013651278, 3013673678, 3013673746, 3013673747, 3013678152,
    3013688060, 3013694998, 3013694999, 3013695012, 3013695032, 3013709811, 3013731965,
    3013737366, 3013750988, 3013754821, 3013755037, 3013765795, 3013765800, 3013765804,
    3013783175, 3013783197, 3013783205, 3013783216, 3013783220, 3013797335, 3013888586,
    3013888597, 3013888600, 3013888601, 3013967523, 3013977482
]

# Ler o arquivo CSV
df = pd.read_csv(r'C:\pythonjr\TED_ANEEL\ugmtcemig.csv', sep=';')

# Iterar sobre os valores permitidos, filtrar os dados e salvar em arquivos CSV separados
for valor in valores_permitidos:
    df_filtrado = df[df['CodGeraMT'] == valor]
    if not df_filtrado.empty:
        nome_arquivo = rf'C:\pythonjr\TED_ANEEL\FINAIS\{valor}.csv'
        df_filtrado.to_csv(nome_arquivo, index=False)

print("Arquivos CSV gerados com sucesso!")
